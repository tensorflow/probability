# Copyright 2021 The TensorFlow Probability Authors.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# pylint: disable=line-too-long
r"""Synthetic dataset generated from the PlasmaSpectroscopy model.

This was generated using the following snippet:

```python
import jax
import jax.numpy as jnp

import tensorflow_probability as tfp
from inference_gym.internal import array_to_source
from inference_gym import using_jax as gym
import numpy as np

num_sensors = 20
num_wavelengths = 20
wavelengths = np.linspace(0.01, 0.2, num_wavelengths)
center_wavelength = wavelengths.mean()

model = gym.targets.PlasmaSpectroscopy(
    tf.zeros((num_wavelengths, num_sensors)),
    wavelengths=wavelengths,
    center_wavelength=center_wavelength)
sample, dataset = model._sample_dataset(seed=jax.random.PRNGKey(2))

sources = []
for k, v in sample._asdict().items():
  sources.append(
    array_to_source.array_to_source(
        k.upper(), v))

for k, v in dataset.items():
  sources.append(
    array_to_source.array_to_source(
        k.upper(), v))

with open('/tmp/synthetic_plasma_spectroscopy.py', 'w') as f:
  f.write("\n\n".join(sources))
```

Note that the final `_sample_dataset` is not reproducible reproducible across
software versions, hence the output is checked in.

"""

import numpy as np

AMPLITUDE = np.array([
    -0.67678463,
    -1.3189365,
    -1.4482341,
    0.0052792346,
    0.6067081,
    0.16397518,
    -0.860614,
    0.08456303,
    -2.568276,
    -0.9221298,
    -0.2101834,
    -0.5590025,
    -0.10608818,
    -1.4224527,
    0.7727255,
    0.1654933,
]).reshape((16,))


TEMPERATURE = np.array([
    0.57469404,
    0.22346735,
    1.4734378,
    0.8634388,
    0.30179763,
    0.46506462,
    -0.059272267,
    -1.4156988,
    -0.68783426,
    0.33958268,
    -0.55064607,
    1.0262468,
    -1.6683097,
    0.55593354,
    0.32084152,
    1.4772958,
]).reshape((16,))


VELOCITY = np.array([
    -0.34384254,
    -0.59809315,
    0.40086195,
    -1.7933046,
    -0.55241865,
    1.7739685,
    1.002691,
    0.16505073,
    -1.5187082,
    -0.08903441,
    0.34761122,
    -0.29944432,
    0.5003399,
    -0.30030075,
    -0.67089385,
    0.25872234,
]).reshape((16,))


SHIFT = np.array([
    -0.4526395,
]).reshape(())


WAVELENGTHS = np.array([
    0.01,
    0.02,
    0.03,
    0.04,
    0.05,
    0.060000000000000005,
    0.06999999999999999,
    0.08,
    0.09,
    0.09999999999999999,
    0.11,
    0.12,
    0.13,
    0.14,
    0.15000000000000002,
    0.16,
    0.17,
    0.18000000000000002,
    0.19,
    0.2,
]).reshape((20,))


CENTER_WAVELENGTH = np.array([
    0.10500000000000001,
]).reshape(())


MEASUREMENTS = np.array([
    -0.4590032,
    0.37897846,
    0.15838043,
    0.8192773,
    2.3124423,
    4.4337163,
    3.5224428,
    3.741441,
    2.6532297,
    4.3084493,
    -0.044596106,
    0.8976828,
    -0.16419043,
    -0.5776877,
    -0.09611144,
    0.67178786,
    -0.8725114,
    0.53115875,
    0.080480635,
    -0.13831872,
    0.2377554,
    -0.24676673,
    0.9534713,
    -0.22164953,
    3.2930026,
    5.047515,
    4.1727066,
    2.7637823,
    3.5389607,
    4.782173,
    0.06528142,
    0.32817116,
    0.48219278,
    0.0022415933,
    0.12053946,
    0.4077151,
    1.1312846,
    0.7224902,
    0.11986295,
    -0.8700538,
    0.28906417,
    0.7308978,
    0.77356124,
    0.7147744,
    3.1881573,
    4.7219353,
    4.227557,
    3.3221426,
    5.1253347,
    4.4423227,
    0.5425409,
    0.7330539,
    0.38541567,
    -0.24432136,
    0.32040516,
    -0.048852433,
    -0.08080024,
    0.29765156,
    0.5534629,
    -0.13304508,
    0.23502712,
    0.52025855,
    2.362849,
    2.1032736,
    4.8877063,
    6.947187,
    4.5276003,
    4.676368,
    6.7397876,
    5.9333277,
    0.8374118,
    2.01951,
    0.17852473,
    0.44058654,
    -0.15810539,
    -0.07124645,
    -0.41005927,
    -0.60916096,
    0.8830382,
    -0.48637328,
    -1.0269631,
    0.22789906,
    3.5919209,
    2.7800903,
    6.569644,
    7.0911865,
    5.9843254,
    4.5139337,
    5.7945776,
    7.2234435,
    2.2581377,
    3.4417934,
    0.48290274,
    -0.16225868,
    -0.21137692,
    0.59555024,
    -0.69854945,
    0.12993997,
    -0.12855604,
    0.17767532,
    0.10401992,
    0.52897775,
    3.1261098,
    3.9271295,
    9.451568,
    8.70495,
    6.951803,
    6.7519493,
    8.594733,
    8.97677,
    2.856995,
    4.3642836,
    1.3943738,
    0.5184868,
    0.6538486,
    -0.0553731,
    0.61298364,
    -0.52233315,
    -0.15687352,
    0.1575819,
    0.5066685,
    0.1492013,
    3.7352257,
    4.6946454,
    10.778032,
    10.14312,
    6.9897947,
    7.6570745,
    7.6134615,
    10.839996,
    3.6812615,
    5.2382803,
    0.9272748,
    0.2881545,
    -0.49097762,
    -0.013005189,
    -0.12919378,
    -0.19176595,
    -0.31841615,
    -0.20632292,
    0.897482,
    0.4717493,
    5.6940784,
    5.2351813,
    11.052841,
    8.893865,
    7.7659354,
    7.278359,
    8.176203,
    10.711946,
    6.1563897,
    6.15184,
    1.6393633,
    0.7776039,
    1.1264992,
    0.20777828,
    -0.04099253,
    0.45505083,
    0.45020327,
    -0.6144522,
    -0.89278764,
    0.7132117,
    5.4594116,
    6.580661,
    11.1231165,
    8.926359,
    6.794299,
    7.494799,
    7.645701,
    8.663197,
    5.7391896,
    7.4654303,
    1.5525527,
    0.47325292,
    0.50628537,
    0.5654121,
    -0.60005075,
    0.5380799,
    0.75010675,
    -0.8786077,
    -0.26541987,
    1.0062369,
    5.917536,
    5.4475694,
    8.962776,
    8.9096985,
    6.524941,
    5.6281443,
    7.0341187,
    7.415457,
    5.360756,
    7.0856524,
    0.6983035,
    -0.034843784,
    0.05815116,
    -0.67415875,
    0.12859318,
    0.29173115,
    -0.30113316,
    0.09773745,
    -0.20834696,
    0.4106313,
    4.8759875,
    6.2882166,
    6.631312,
    7.2048864,
    5.0118313,
    5.76062,
    6.0700097,
    4.248549,
    5.9377446,
    5.3127804,
    2.0150046,
    -0.24142121,
    0.042954344,
    0.31019762,
    -1.4427088,
    -0.6767444,
    -0.12894586,
    -0.16496193,
    0.30197698,
    0.70833755,
    5.2416525,
    4.405308,
    4.141774,
    6.686074,
    5.101449,
    5.5042176,
    6.195249,
    4.9175014,
    4.075947,
    5.858494,
    1.3484001,
    -0.23697586,
    -0.67863226,
    -0.30322158,
    -0.68839073,
    -0.6670317,
    0.06504059,
    -0.48677292,
    -0.097647674,
    0.73040634,
    3.7136104,
    4.1344724,
    3.0926166,
    5.22816,
    3.926086,
    3.9030032,
    6.252046,
    3.0033717,
    3.6924279,
    3.3145332,
    1.5273939,
    -0.2240957,
    0.040433016,
    0.26682878,
    0.13306823,
    -0.19042966,
    -0.3138338,
    -0.02891805,
    -0.073886946,
    0.55032367,
    3.357552,
    3.8683167,
    2.5414236,
    5.7460303,
    5.159134,
    3.9072194,
    6.394715,
    2.0057418,
    3.180806,
    3.2007017,
    0.10944003,
    -0.13589339,
    -0.543666,
    -0.28955862,
    0.0535881,
    -0.43128714,
    -0.31151727,
    -0.10763182,
    -0.4921207,
    0.51329786,
    2.1336432,
    2.4165246,
    2.69944,
    5.777577,
    3.961132,
    3.956883,
    5.234124,
    2.588011,
    3.2292664,
    3.1392186,
    1.6328335,
    0.10212917,
    -1.0147538,
    0.3018588,
    -0.12610543,
    0.89710426,
    -0.17046613,
    -0.46648067,
    -0.549175,
    0.13156202,
    1.8343537,
    3.2701056,
    1.3186411,
    5.9117556,
    3.3618834,
    2.919626,
    5.199527,
    1.4636362,
    3.1486642,
    1.4292852,
    1.2113197,
    0.23315075,
    0.147672,
    -0.27040133,
    -0.90078545,
    -0.4048917,
    -0.34707227,
    0.384595,
    0.116757095,
    0.29560095,
    2.3550878,
    2.1976712,
    2.116509,
    4.570855,
    2.4368372,
    3.8482769,
    4.4730406,
    1.9791476,
    2.7819998,
    0.67298895,
    0.6602536,
    0.6911703,
    -0.5148425,
    0.10556061,
    -0.20107399,
    -0.83828026,
    -0.0774215,
    0.32847655,
    -0.2883146,
    1.590999,
    1.4234254,
    1.6135638,
    1.5432106,
    4.476751,
    2.5739455,
    3.2941067,
    3.7132478,
    1.7084577,
    2.0449324,
    -0.01425159,
    0.799549,
    0.3509603,
    0.47747552,
    0.13117759,
    -0.97384745,
    1.1591228,
    0.22225721,
    0.29805276,
    -0.5014714,
    0.53192234,
    0.629024,
    0.9710295,
    0.21472424,
    3.9211314,
    2.4856699,
    2.6575131,
    4.0873804,
    1.3468995,
    2.0985894,
    0.2841391,
    -0.13569601,
    -0.09088544,
    -0.21536636,
    0.032447033,
    -0.5562008,
    -1.5297456,
    0.47162142,
    0.52928036,
    -0.3498851,
    -0.2314626,
    0.14439955,
    1.2847612,
    1.2684085,
    3.8614385,
    2.1330612,
    2.861363,
    4.015196,
    0.36382645,
    2.224851,
    0.9823539,
    -0.24519335,
    0.9304521,
    0.14760973,
    0.64223593,
    0.29272845,
    -0.34137893,
    -0.41749373,
    -1.1427553,
]).reshape((20, 20))
